"use strict";function DigitClock(){var self=this;this.init=function(wid){var s,t;(self.clock=document.getElementById(wid),self.host=self.clock.getAttribute("host"),self.ampm="true"==self.clock.getAttribute("ampm"),self.nightSign="true"==self.clock.getAttribute("nightsign"),self.cityid=self.clock.getAttribute("cityid"),self.lang=self.clock.getAttribute("lang"),self.sunInfo="true"==self.clock.getAttribute("sun"),self.auto="true"==self.clock.getAttribute("auto"),self.cityid||auto)&&(self.tick=null,window.moment?self.start():(t=document.getElementsByTagName("script")[0],(s=document.createElement("script")).type="text/javascript",s.src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js",s.onload=function(){var s2;(s2=document.createElement("script")).type="text/javascript",s2.src="https://cdnjs.cloudflare.com/ajax/libs/moment-timezone/0.5.42/moment-timezone-with-data-10-year-range.min.js",s2.onload=function(){self.start()},t.parentNode.insertBefore(s2,t)},t.parentNode.insertBefore(s,t)))},this.start=function(){clearTimeout(self.tick);var xhr=new XMLHttpRequest;xhr.onreadystatechange=function(){if(xhr.readyState==XMLHttpRequest.DONE&&200==xhr.status){var city=JSON.parse(xhr.responseText);"DPAC"==self.clock.className?self.clock.querySelector(".DPACh").innerHTML=city.title:self.clock.querySelector(".DPDCh").innerHTML=city.title,self.clock.querySelector(".DPl").href=city.link,self.location=city.location,self.sunrise=city.sunrise,self.sunset=city.sunset,self.dayDuration=city.dayDuration;var now=moment().tz(self.location);if(self.oldDay=now.date(),self.date=city.date,self.timeTick(),self.tick=setInterval(self.timeTick,1e3),self.sunInfo){self.clock.querySelector("."+self.clock.className+"s").style.display="block";var sunrise=moment(1e3*self.sunrise).tz(self.location),sunriseH=sunrise.hour(),sunriseM=sunrise.minute(),sunset=moment(1e3*self.sunset).tz(self.location),sunsetH=sunset.hour(),sunsetM=sunset.minute();if(self.ampm){var sunriseFormat=self.formatAmPm(sunriseH),sunriseAmpm=sunriseFormat.ampm;sunriseH=sunriseFormat.h;var sunsetFormat=self.formatAmPm(sunsetH),sunsetAmpm=sunsetFormat.ampm;sunsetH=sunsetFormat.h,self.clock.querySelector("."+self.clock.className+"sr sup").innerHTML=sunriseAmpm,self.clock.querySelector("."+self.clock.className+"sr sup").style.display="inline",self.clock.querySelector("."+self.clock.className+"ss sup").innerHTML=sunsetAmpm,self.clock.querySelector("."+self.clock.className+"ss sup").style.display="inline"}else self.clock.querySelector("."+self.clock.className+"sr sup").style.display="none",self.clock.querySelector("."+self.clock.className+"ss sup").style.display="none";self.clock.querySelector("."+self.clock.className+"sr").childNodes[2].textContent=self.validateClock(sunriseH,!0)+":"+self.validateClock(sunriseM),self.clock.querySelector("."+self.clock.className+"ss").childNodes[2].textContent=self.validateClock(sunsetH,!0)+":"+self.validateClock(sunsetM),self.clock.querySelector("."+self.clock.className+"sl").textContent=self.dayDuration}else self.clock.querySelector("."+self.clock.className+"s").style.display="none"}},xhr.open("GET",self.host+"/api/widget/city/"+self.cityid+"/?lang="+self.lang+"&auto="+ +self.auto,!0),xhr.send()},this.timeTick=function(){var now=moment();if(self.location&&(now=now.tz(self.location)),now.date()!=self.oldDay)return self.oldDay=now.date(),void self.start();"DPAC"==self.clock.className?self.updateAnalog(now):self.update(now)},this.updateAnalog=function(now){var h=now.hour(),m=now.minute(),s=now.second(),rotateSec=(now.month(),now.day(),6*s);self.clock.querySelector(".DPACts").style.transform="rotate("+rotateSec+"deg)";var rotateMins=6*m+s/60*6;self.clock.querySelector(".DPACtm").style.transform="rotate("+rotateMins+"deg)",h>=12&&(h-=12),0==h&&(h=12);var rotateHours=30*h+m/60*30;self.clock.querySelector(".DPACth").style.transform="rotate("+rotateHours+"deg)",self.clock.querySelector(".DPACtn").style.display="none",self.nightSign&&(now.unix()<self.sunrise||now.unix()>self.sunset)&&(self.clock.querySelector(".DPACtn").style.display=""),self.clock.querySelector(".DPACd .DPACdt").innerHTML=self.date},this.update=function(now){var h=now.hour(),m=now.minute(),s=now.second(),nowAmpm=(now.month(),now.day(),"");if(self.ampm){var res=self.formatAmPm(h);nowAmpm=res.ampm,h=res.h}self.clock.querySelector(".DPDCt12").innerHTML=nowAmpm,self.clock.querySelector(".DPDCtn").style.display="none",self.nightSign&&(now.unix()<self.sunrise||now.unix()>self.sunset)&&(self.clock.querySelector(".DPDCtn").style.display=""),self.clock.querySelector(".DPDCth").innerHTML=self.validateClock(h,!0),self.clock.querySelector(".DPDCtm").innerHTML=self.validateClock(m),self.clock.querySelector(".DPDCts").innerHTML=self.validateClock(s),self.clock.querySelector(".DPDCd .DPDCdt").innerHTML=self.date},this.validateClock=function(t,isHours){return t>=10||self.ampm&&isHours?t:"0"+t},this.formatAmPm=function(h){var nowAmpm="am";return h>=12&&(h-=12,nowAmpm="pm"),0==h&&(h=12),{h:h,ampm:nowAmpm}}}